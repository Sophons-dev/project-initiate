// User Models
// This file contains all user-related models

model User {
  id            String    @id @map("_id") @db.ObjectId @default(auto())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  auth0Id       String?   @unique

  // Role Reference
  roleId        String    @db.ObjectId
  role          Role      @relation("UserToRole", fields: [roleId], references: [id])

  // Embedded objects
  profile       UserProfile?
  preferences   UserPreferences?
  modelData         UserModelData?

  // Relations
  opportunities     UserOpportunity[]
  questionAnswers   UserQuestionAnswer[]
  recommendations   OpportunityRecommendation[]
  careerInsights    CareerInsight[]
  careerInsightLogs CareerInsightLog[]
}

// Embedded object types
type UserProfile {
  fullName     String?
  avatarUrl    String?
  bio          String?
  location     String?
  organization String?
  website      String?
}

type UserPreferences {
  interests                 String[]
  goals                     String?
  preferredOpportunityTypes String[]
  skills                    String[]
  onboardingCompleted       Boolean   @default(false)
  preferencesUpdatedAt      DateTime?
}

type UserModelData {
  learningStyle    String?
  availability     String?
  preferredWorkEnv String?
  remoteFriendly   Boolean?
  updatedAt        DateTime?
}

model UserQuestionAnswer {
  id         String    @id @map("_id") @db.ObjectId
  userId     String    @db.ObjectId
  questionId String    @db.ObjectId
  answer     String
  updatedAt  DateTime?
  user       User      @relation(fields: [userId], references: [id])
  question   Question  @relation(fields: [questionId], references: [id])

  @@index([userId])
  @@index([questionId])
}

model UserOpportunity {
  id            String                @id @map("_id") @db.ObjectId
  userId        String                @db.ObjectId
  opportunityId String                @db.ObjectId
  status        UserOpportunityStatus @default(saved)
  createdAt     DateTime?
  updatedAt     DateTime?
  user          User                  @relation(fields: [userId], references: [id])
  opportunity   Opportunity           @relation(fields: [opportunityId], references: [id])

  @@index([userId])
  @@index([opportunityId])
}
