// User Models
// This file contains all user-related models

model User {
  id            String    @id @map("_id") @db.ObjectId @default(auto())
  clerkId       String    @unique @map("clerkId")
  userType      UserType?

  // Basic auth info
  email         String?   @unique
  emailVerified DateTime?

  // Embedded objects
  profile       UserProfile?
  preferences   UserPreferences?
  modelData     UserModelData?

  // Relations
  opportunities     UserOpportunity[]
  questionAnswers   UserQuestionAnswer[]
  recommendations   OpportunityRecommendation[]
  careerInsights    CareerInsight[]
  careerInsightLogs CareerInsightLog[]

  @@index([id])
  @@index([clerkId])
}

// Embedded object types
type UserProfile {
  name          String?
  image         String?
  location      String?
  organization  String?
  position      String?
  website       String?
  gender        String?
  dateOfBirth   DateTime?
}

type UserPreferences {
  interests                 String[]
  goals                     String?
  preferredOpportunityTypes String[]
  skills                    String[]
  onboardingCompleted       Boolean   @default(false)
  preferencesUpdatedAt      DateTime?
}

type UserModelData {
  learningStyle    String?
  availability     String?
  preferredWorkEnv String?
  remoteFriendly   Boolean?
  updatedAt        DateTime?
}

model UserQuestionAnswer {
  id         String    @id @map("_id") @db.ObjectId
  userId     String    @db.ObjectId
  questionId String    @db.ObjectId
  answer     String
  updatedAt  DateTime?
  user       User      @relation(fields: [userId], references: [id])
  question   Question  @relation(fields: [questionId], references: [id])

  @@index([userId])
  @@index([questionId])
}

model UserOpportunity {
  id            String                @id @map("_id") @db.ObjectId
  userId        String                @db.ObjectId
  opportunityId String                @db.ObjectId
  status        UserOpportunityStatus @default(saved)
  createdAt     DateTime?
  updatedAt     DateTime?
  user          User                  @relation(fields: [userId], references: [id])
  opportunity   Opportunity           @relation(fields: [opportunityId], references: [id])

  @@index([userId])
  @@index([opportunityId])
}
