#!/bin/sh

echo 'ğŸ‘·â€â™‚ï¸ Starting pre-commit checks...'

# Get list of staged files before formatting
STAGED_FILES=$(git diff --cached --name-only)

echo 'ğŸ¨ Formatting ...'
bun run format || {
  echo 'âŒ Formatting failed.'
  exit 1
}

echo 'ğŸ§¹ Linting ...'
bun run lint || {
  echo 'âŒ Linting failed. Please fix the errors before committing.'
  exit 1
}

# Only add back the files that were originally staged
if [ -n "$STAGED_FILES" ]; then
  echo "$STAGED_FILES" | xargs git add
fi

echo 'âœ… All pre-commit checks passed. Proceeding with commit. ğŸš€'
